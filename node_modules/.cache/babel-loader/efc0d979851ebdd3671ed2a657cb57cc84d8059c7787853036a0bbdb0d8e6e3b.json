{"ast":null,"code":"// src/App.js\nimport React,{useState,useEffect}from\"react\";import{supabase}from\"./utils/supabaseClient\";import TimeTable from\"./components/TimeTable\";import ReserveForm from\"./components/ReserveForm\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[reservations,setReservations]=useState([]);const[now,setNow]=useState(new Date());// 1) 초기 데이터 로드\nuseEffect(()=>{supabase.from(\"reservations\").select(\"*\").order(\"inserted_at\",{ascending:true}).then(_ref=>{let{data}=_ref;return setReservations(data||[]);});},[]);// 2) 실시간 리스너 (새 예약이나 취소가 들어올 때마다 반영)\nuseEffect(()=>{const subscription=supabase.from(\"reservations\").on(\"*\",payload=>{// INSERT / DELETE 이벤트에 따라 상태 갱신\nsupabase.from(\"reservations\").select(\"*\").order(\"inserted_at\",{ascending:true}).then(_ref2=>{let{data}=_ref2;return setReservations(data||[]);});}).subscribe();return()=>{supabase.removeSubscription(subscription);};},[]);// 3) 현재 시간 초단위 업데이트\nuseEffect(()=>{const timer=setInterval(()=>setNow(new Date()),1000);return()=>clearInterval(timer);},[]);// 4) 예약 추가\nconst handleReserve=async newRes=>{await supabase.from(\"reservations\").insert(newRes);};// 5) 예약 취소\nconst handleCancel=async id=>{await supabase.from(\"reservations\").delete().eq(\"id\",id);};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"header\",{style:{display:\"flex\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC2A4\\uD06C\\uB9B0\\uACE8\\uD504 \\uC608\\uC57D\"}),/*#__PURE__*/_jsx(\"div\",{children:now.toLocaleTimeString(\"ko-KR\")})]}),/*#__PURE__*/_jsx(TimeTable,{reservations:reservations,onCancel:handleCancel,currentTime:now}),/*#__PURE__*/_jsx(ReserveForm,{reservations:reservations,onReserve:handleReserve,currentTime:now})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","supabase","TimeTable","ReserveForm","jsx","_jsx","jsxs","_jsxs","App","reservations","setReservations","now","setNow","Date","from","select","order","ascending","then","_ref","data","subscription","on","payload","_ref2","subscribe","removeSubscription","timer","setInterval","clearInterval","handleReserve","newRes","insert","handleCancel","id","delete","eq","className","children","style","display","justifyContent","toLocaleTimeString","onCancel","currentTime","onReserve"],"sources":["/Users/leeduhui/work/golf_reservation/golf_reservation_app/src/App.js"],"sourcesContent":["// src/App.js\nimport React, { useState, useEffect } from \"react\";\nimport { supabase } from \"./utils/supabaseClient\";\nimport TimeTable from \"./components/TimeTable\";\nimport ReserveForm from \"./components/ReserveForm\";\n\nfunction App() {\n  const [reservations, setReservations] = useState([]);\n  const [now, setNow] = useState(new Date());\n\n  // 1) 초기 데이터 로드\n  useEffect(() => {\n    supabase\n      .from(\"reservations\")\n      .select(\"*\")\n      .order(\"inserted_at\", { ascending: true })\n      .then(({ data }) => setReservations(data || []));\n  }, []);\n\n  // 2) 실시간 리스너 (새 예약이나 취소가 들어올 때마다 반영)\n  useEffect(() => {\n    const subscription = supabase\n      .from(\"reservations\")\n      .on(\"*\", payload => {\n        // INSERT / DELETE 이벤트에 따라 상태 갱신\n        supabase\n          .from(\"reservations\")\n          .select(\"*\")\n          .order(\"inserted_at\", { ascending: true })\n          .then(({ data }) => setReservations(data || []));\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeSubscription(subscription);\n    };\n  }, []);\n\n  // 3) 현재 시간 초단위 업데이트\n  useEffect(() => {\n    const timer = setInterval(() => setNow(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  // 4) 예약 추가\n  const handleReserve = async newRes => {\n    await supabase.from(\"reservations\").insert(newRes);\n  };\n\n  // 5) 예약 취소\n  const handleCancel = async id => {\n    await supabase.from(\"reservations\").delete().eq(\"id\", id);\n  };\n\n  return (\n    <div className=\"container\">\n      <header style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n        <h1>스크린골프 예약</h1>\n        <div>{now.toLocaleTimeString(\"ko-KR\")}</div>\n      </header>\n      <TimeTable\n        reservations={reservations}\n        onCancel={handleCancel}\n        currentTime={now}\n      />\n      <ReserveForm\n        reservations={reservations}\n        onReserve={handleReserve}\n        currentTime={now}\n      />\n    </div>\n  );\n}\n\nexport default App;\n\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,QAAQ,KAAQ,wBAAwB,CACjD,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAC9C,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnD,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACY,GAAG,CAAEC,MAAM,CAAC,CAAGb,QAAQ,CAAC,GAAI,CAAAc,IAAI,CAAC,CAAC,CAAC,CAE1C;AACAb,SAAS,CAAC,IAAM,CACdC,QAAQ,CACLa,IAAI,CAAC,cAAc,CAAC,CACpBC,MAAM,CAAC,GAAG,CAAC,CACXC,KAAK,CAAC,aAAa,CAAE,CAAEC,SAAS,CAAE,IAAK,CAAC,CAAC,CACzCC,IAAI,CAACC,IAAA,MAAC,CAAEC,IAAK,CAAC,CAAAD,IAAA,OAAK,CAAAT,eAAe,CAACU,IAAI,EAAI,EAAE,CAAC,GAAC,CACpD,CAAC,CAAE,EAAE,CAAC,CAEN;AACApB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAqB,YAAY,CAAGpB,QAAQ,CAC1Ba,IAAI,CAAC,cAAc,CAAC,CACpBQ,EAAE,CAAC,GAAG,CAAEC,OAAO,EAAI,CAClB;AACAtB,QAAQ,CACLa,IAAI,CAAC,cAAc,CAAC,CACpBC,MAAM,CAAC,GAAG,CAAC,CACXC,KAAK,CAAC,aAAa,CAAE,CAAEC,SAAS,CAAE,IAAK,CAAC,CAAC,CACzCC,IAAI,CAACM,KAAA,MAAC,CAAEJ,IAAK,CAAC,CAAAI,KAAA,OAAK,CAAAd,eAAe,CAACU,IAAI,EAAI,EAAE,CAAC,GAAC,CACpD,CAAC,CAAC,CACDK,SAAS,CAAC,CAAC,CAEd,MAAO,IAAM,CACXxB,QAAQ,CAACyB,kBAAkB,CAACL,YAAY,CAAC,CAC3C,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN;AACArB,SAAS,CAAC,IAAM,CACd,KAAM,CAAA2B,KAAK,CAAGC,WAAW,CAAC,IAAMhB,MAAM,CAAC,GAAI,CAAAC,IAAI,CAAC,CAAC,CAAC,CAAE,IAAI,CAAC,CACzD,MAAO,IAAMgB,aAAa,CAACF,KAAK,CAAC,CACnC,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAG,aAAa,CAAG,KAAM,CAAAC,MAAM,EAAI,CACpC,KAAM,CAAA9B,QAAQ,CAACa,IAAI,CAAC,cAAc,CAAC,CAACkB,MAAM,CAACD,MAAM,CAAC,CACpD,CAAC,CAED;AACA,KAAM,CAAAE,YAAY,CAAG,KAAM,CAAAC,EAAE,EAAI,CAC/B,KAAM,CAAAjC,QAAQ,CAACa,IAAI,CAAC,cAAc,CAAC,CAACqB,MAAM,CAAC,CAAC,CAACC,EAAE,CAAC,IAAI,CAAEF,EAAE,CAAC,CAC3D,CAAC,CAED,mBACE3B,KAAA,QAAK8B,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB/B,KAAA,WAAQgC,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,eAAgB,CAAE,CAAAH,QAAA,eAClEjC,IAAA,OAAAiC,QAAA,CAAI,6CAAQ,CAAI,CAAC,cACjBjC,IAAA,QAAAiC,QAAA,CAAM3B,GAAG,CAAC+B,kBAAkB,CAAC,OAAO,CAAC,CAAM,CAAC,EACtC,CAAC,cACTrC,IAAA,CAACH,SAAS,EACRO,YAAY,CAAEA,YAAa,CAC3BkC,QAAQ,CAAEV,YAAa,CACvBW,WAAW,CAAEjC,GAAI,CAClB,CAAC,cACFN,IAAA,CAACF,WAAW,EACVM,YAAY,CAAEA,YAAa,CAC3BoC,SAAS,CAAEf,aAAc,CACzBc,WAAW,CAAEjC,GAAI,CAClB,CAAC,EACC,CAAC,CAEV,CAEA,cAAe,CAAAH,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}